package com.xiaochao.å½’å¹¶æ’åº.å¤šè·¯å½’å¹¶;

import java.util.HashSet;
import java.util.PriorityQueue;
import java.util.Queue;
import java.util.Set;

/**
 * ç»™ä½ ä¸€ä¸ªæ•´æ•° n ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›ç¬¬ n ä¸ª ä¸‘æ•° ã€‚
 * ä¸‘æ•° å°±æ˜¯åªåŒ…å«è´¨å› æ•° 2ã€3 å’Œ/æˆ– 5 çš„æ­£æ•´æ•°ã€‚
 * ç¤ºä¾‹ 1ï¼š
 * è¾“å…¥ï¼šn = 10
 * è¾“å‡ºï¼š12
 * è§£é‡Šï¼š[1, 2, 3, 4, 5, 6, 8, 9, 10, 12] æ˜¯ç”±å‰ 10 ä¸ªä¸‘æ•°ç»„æˆçš„åºåˆ—ã€‚
 * ç¤ºä¾‹ 2ï¼š
 * è¾“å…¥ï¼šn = 1
 * è¾“å‡ºï¼š1
 * è§£é‡Šï¼š1 é€šå¸¸è¢«è§†ä¸ºä¸‘æ•°ã€‚
 * æç¤ºï¼š
 * 1 <= n <= 1690
 */
public class ä¸‘æ•°äºŒ {
    /**
     * ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå°æ ¹å †ï¼‰è§£æ³•
     * æœ‰äº†åŸºæœ¬çš„åˆ†ææ€è·¯ï¼Œä¸€ä¸ªç®€å•çš„è§£æ³•æ˜¯ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼š
     * 1. èµ·å§‹å…ˆå°†æœ€å°ä¸‘æ•° 1 æ”¾å…¥é˜Ÿåˆ—
     * 2. æ¯æ¬¡ä»é˜Ÿåˆ—å–å‡ºæœ€å°å€¼ xï¼Œç„¶åå°† x æ‰€å¯¹åº”çš„ä¸‘æ•° 2xã€3x å’Œ 5x è¿›è¡Œå…¥é˜Ÿã€‚
     * 3. å¯¹æ­¥éª¤ 2 å¾ªç¯å¤šæ¬¡ï¼Œç¬¬ n æ¬¡å‡ºé˜Ÿçš„å€¼å³æ˜¯ç­”æ¡ˆã€‚
     * ä¸ºäº†é˜²æ­¢åŒä¸€ä¸‘æ•°å¤šæ¬¡è¿›é˜Ÿï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ•°æ®ç»“æ„ Set æ¥è®°å½•å…¥è¿‡é˜Ÿåˆ—çš„ä¸‘æ•°ã€‚
     * @param n
     * @return
     */
    public int nthUglyNumber(int n) {
        int[] nums = new int[]{2,3,5};
        Set<Long> set = new HashSet<>();
        Queue<Long> queue = new PriorityQueue<>();
        set.add(1L);
        queue.add(1L);
        for (int i = 1; i <= n ; i++) {
            long x = queue.poll();
            if (i == n) return (int)x;
            for (int num : nums) {
                long t = num * x;
                if (!set.contains(t)){
                    set.add(t);
                    queue.add(t);
                }
            }
        }
        return -1;
    }
    //â€¢ æ—¶é—´å¤æ‚åº¦ï¼šä»ä¼˜å…ˆé˜Ÿåˆ—ä¸­å–æœ€å°å€¼ä¸º O(1)ï¼Œå¾€ä¼˜å…ˆé˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´ å¤æ‚åº¦ä¸º
//O(log n)ã€‚æ•´ä½“å¤æ‚åº¦ä¸º O(n log n)
//â€¢ ç©ºé—´å¤æ‚åº¦ï¼šO(n)

    /**
     * å¤šè·¯å½’å¹¶ï¼ˆå¤šæŒ‡é’ˆï¼‰è§£æ³•
     * ä¸¾ä¸ªğŸŒ°ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦æ±‚å¾— [1, 2, 3, ..., 10, 12] ä¸‘æ•°åºåˆ— arr çš„æœ€åä¸€ä½ï¼Œé‚£ä¹ˆè¯¥åºåˆ—å¯ä»¥çœ‹
     * ä½œä»¥ä¸‹ä¸‰ä¸ªæœ‰åºåºåˆ—å½’å¹¶è€Œæ¥ï¼š
     * â€¢ 1 âˆ— 2, 2 âˆ— 2, 3 âˆ— 2, ..., 10 âˆ— 2, 12 âˆ— 2 ï¼Œå°† 2 æå‡ºï¼Œå³ arr âˆ— 2
     * â€¢ 1 âˆ— 3, 2 âˆ— 3, 3 âˆ— 3, ..., 10 âˆ— 3, 12 âˆ— 3 ï¼Œå°† 3 æå‡ºï¼Œå³ arr âˆ— 3
     * â€¢ 1 âˆ— 5, 2 âˆ— 5, 3 âˆ— 5, ..., 10 âˆ— 5, 12 âˆ— 5 ï¼Œå°† 5 æå‡ºï¼Œå³ arr âˆ— 5
     * å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªæŒ‡é’ˆæ¥æŒ‡å‘ç›®æ ‡åºåˆ— arr çš„æŸä¸ªä¸‹æ ‡ï¼ˆä¸‹æ ‡ 0 ä½œä¸ºå“¨å…µä¸ä½¿ç”¨ï¼Œèµ·å§‹éƒ½
     * ä¸º 1ï¼‰ï¼Œä½¿ç”¨ arr[ä¸‹æ ‡] âˆ— è´¨å› æ•° ä»£è¡¨å½“å‰ä½¿ç”¨åˆ°ä¸‰ä¸ªæœ‰åºåºåˆ—ä¸­çš„å“ªä¸€ä½ï¼ŒåŒæ—¶ä½¿ç”¨ idx
     * è¡¨ç¤ºå½“å‰ç”Ÿæˆåˆ° arr å“ªä¸€ä½ä¸‘æ•°ã€‚
     */
    public int nthUglyNumber2(int n) {
        //ansç”¨ä½œå­˜å‚¨å·²æœ‰ä¸‘æ•°(ä»ä¸‹æ ‡1å¼€å§‹å­˜å‚¨ï¼Œç¬¬ä¸€ä¸ªä¸‘æ•°ä¸º1)
        int[] ans = new int[n + 1];
        ans[1] = 1;
        // ç”±äºä¸‰ä¸ªæœ‰åºåºåˆ—éƒ½æ˜¯ç”±ã€Œå·²æœ‰ä¸‘æ•°ã€*ã€Œè´¨å› æ•°ã€è€Œæ¥
        // i2ã€i3 å’Œ i5 åˆ†åˆ«ä»£è¡¨ä¸‰ä¸ªæœ‰åºåºåˆ—å½“å‰ä½¿ç”¨åˆ°å“ªä¸€ä½ã€Œå·²æœ‰ä¸‘æ•°ã€ä¸‹æ ‡ï¼ˆèµ·å§‹éƒ½æŒ‡å‘ 1ï¼‰
        for (int i2 = 1, i3 = 1, i5 = 1,idx = 2;idx <= n; idx++) {
            // ç”± ans[iX] * X å¯å¾—å½“å‰æœ‰åºåºåˆ—æŒ‡å‘å“ªä¸€ä½
            int a= ans[i2] * 2,b = ans[i3] * 3,c = ans[i5] * 5;
            // å°†ä¸‰ä¸ªæœ‰åºåºåˆ—ä¸­çš„æœ€å°ä¸€ä½å­˜å…¥ã€Œå·²æœ‰ä¸‘æ•°ã€åºåˆ—ï¼Œå¹¶å°†å…¶ä¸‹æ ‡åç§»
            int min = Math.min(a,Math.min(b,c));
            // ç”±äºå¯èƒ½ä¸åŒæœ‰åºåºåˆ—ä¹‹é—´äº§ç”Ÿç›¸åŒä¸‘æ•°ï¼Œå› æ­¤åªè¦ä¸€æ ·çš„ä¸‘æ•°å°±è·³è¿‡ï¼ˆä¸èƒ½ä½¿ç”¨ else if ï¼‰
            if (min == a) i2++;
            if (min == b) i3++;
            if (min == c) i5++;
            ans[idx] = min;
        }
        return ans[n];
    }
    //â€¢ æ—¶é—´å¤æ‚åº¦ï¼šO(n)
    //â€¢ ç©ºé—´å¤æ‚åº¦ï¼šO(n)
}

