package com.leixing.é€’å½’è¿­ä»£.BFS;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

/**
 * å›æº¯è§£æ³•
 * æˆ‘ä»¬çŸ¥é“ä½¿ç”¨ Set è™½ç„¶æ˜¯ O(1) æ“ä½œï¼Œä½†æ˜¯åªæ˜¯å‡æ‘Š O(1)ã€‚
 * å› æ­¤æˆ‘ä»¬æ¥è€ƒè™‘ä¸ä½¿ç”¨ Set çš„åšæ³•ã€‚
 * æˆ‘ä»¬ä½¿ç”¨ Set çš„ç›®çš„æ˜¯ä¸ºäº†å»é‡ï¼Œé‚£ä»€ä¹ˆæ—¶å€™ä¼šå¯¼è‡´çš„é‡å¤å‘¢ï¼Ÿ
 * å…¶å®å°±æ˜¯ç›¸åŒçš„å…ƒç´ ï¼Œä¸åŒçš„å†³ç­–æ–¹æ¡ˆå¯¹åº”åŒæ ·çš„ç»“æœã€‚
 * ä¸¾ä¸ªğŸŒ°ï¼Œ[1,1,1] çš„æ•°æ®ï¼Œåªé€‰æ‹©ç¬¬ä¸€ä¸ªå’Œåªé€‰æ‹©ç¬¬ä¸‰ä¸ªï¼ˆä¸åŒçš„å†³ç­–æ–¹æ¡ˆï¼‰ï¼Œç»“æœæ˜¯ä¸€æ ·çš„ã€‚
 * å› æ­¤å¦‚æœæˆ‘ä»¬å¸Œæœ›å»é‡çš„è¯ï¼Œä¸èƒ½å•çº¯çš„åˆ©ç”¨ã€ŒæŸä¸ªä¸‹æ ‡æ˜¯å¦è¢«é€‰æ‹©ã€æ¥è¿›è¡Œå†³ç­–ï¼Œè€Œæ˜¯è¦æ‰¾åˆ°æŸä¸ªæ•°å€¼çš„è¿ç»­ä¸€æ®µï¼Œæ ¹æ®è¯¥æ•°å€¼çš„é€‰æ‹©æ¬¡æ•°ç±»è¿›è¡Œå†³ç­–ã€‚
 * è¿˜æ˜¯é‚£ä¸ªğŸŒ°ï¼Œ[1,1,1] çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦æ‰¾åˆ°æ•°å€¼ä¸º 1 çš„è¿ç»­ä¸€æ®µï¼Œç„¶åå†³ç­–é€‰æ‹© 0 æ¬¡ã€é€‰æ‹© 1 æ¬¡ã€é€‰æ‹© 2 æ¬¡ ... ä»è€Œç¡®ä¿ä¸ä¼šå‡ºç°é‡å¤
 * ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†å†³ç­–æ–¹æ¡ˆä»ã€ŒæŸä¸ªä¸‹æ ‡æ˜¯å¦è¢«é€‰æ‹©ã€ä¿®æ”¹ä¸ºã€Œç›¸åŒçš„æ•°å€¼è¢«é€‰æ‹©çš„ä¸ªæ•°ã€ã€‚è¿™æ ·è‚¯å®šä¸ä¼šå‡ºç°é‡å¤ï¼Œå› ä¸º [1,1,1] ä¸ä¼šå› ä¸ºåªé€‰æ‹©ç¬¬ä¸€ä¸ªå’Œåªé€‰æ‹©ç¬¬ä¸‰ä¸ªäº§ç”Ÿä¸¤ä¸ª [1] çš„æ–¹æ¡ˆï¼Œåªä¼šå› ä¸º 1 è¢«é€‰æ‹©ä¸€æ¬¡ï¼Œäº§ç”Ÿä¸€ä¸ª [1] çš„æ–¹æ¡ˆ
 */
public class å­é›†äºŒ2 {
    public List<List<Integer>> subsetsWithDup(int [] nums){
        Arrays.sort(nums);
        List<List<Integer>> ans=new ArrayList<>();
        List<Integer> cur=new ArrayList<>();
        dfs(nums,0,cur,ans);
        return new ArrayList<>(ans);
    }

    /**
     * @param nums åŸè¼¸å…¥æ•¸çµ„
     * @param u ç•¶å‰æ±ºç­–åˆ°åŸæ•¸çµ„ä¸­çš„å“ªä¸€ä½
     * @param cur ç•¶å‰æ–¹æ¡ˆ
     * @param ans æœ€çµ‚æ–¹æ¡ˆ
     */
    void dfs(int[] nums, int u, List<Integer> cur, List<List<Integer>> ans) {
        int n=nums.length;
        if (n == u){
            ans.add(new ArrayList<>(cur));
            return;
        }

        //è¨˜éŒ„ç•¶å‰ä½ç½®æ˜¯ä»€éº½å€¼(ä»¤æ•¸å€¼ç‚ºt),ä¸¦æ‰¾å‡ºæ•¸å€¼ç‚ºtçš„é€£çºŒä¸€æ®µ
        int t=nums[u];
        int last=u;
        while (last < n && nums[last] == nums[u]) last++;

        //ä¸é¸ç•¶å‰ä½ç½®çš„å…ƒç´ ï¼Œç›´æ¥è·³åˆ°lastå¾€ä¸‹æ±ºç­–
        dfs(nums,last,cur,ans);

        //æ±ºç­–é¸æ“‡ä¸åŒå€‹æ•¸çš„tçš„æƒ…æ³ï¼šé¸æ“‡ä¸€å€‹.2å€‹.3å€‹...kå€‹
        for (int i = u;i < last;i++){
            cur.add(nums[i]);
            dfs(nums,last,cur,ans);
        }

        //å›æº¯å°æ•¸å€¼tçš„é¸æ“‡
        for(int i = u; i < last;i++){
            cur.remove(cur.size() - 1);
        }
    }
}
//æ—¶é—´å¤æ‚åº¦ï¼šæ’åºå¤æ‚åº¦ä¸º O(nlogn)ï¼Œçˆ†æœå¤æ‚åº¦ä¸º (2^n)æ¯ä¸ªæ–¹æ¡ˆé€šè¿‡æ·±æ‹·è´å­˜å…¥ç­”æ¡ˆï¼Œå¤æ‚åº¦ä¸º O(n)ã€‚æ•´ä½“å¤æ‚åº¦ä¸º (n * 2^n)
//ç©ºé—´å¤æ‚åº¦ï¼šæ€»å…±æœ‰ 2^n ä¸ªæ–¹æ¡ˆï¼Œæ¯ä¸ªæ–¹æ¡ˆæœ€å¤šå ç”¨ O(n) ç©ºé—´ï¼Œæ•´ä½“å¤æ‚åº¦ä¸º (n * 2^n)
